import{r as n,j as s}from"./index-94dceae6.js";import{A as N,R as T,a as L,H as I,b as R}from"./AdminSidebar-b01626fa.js";import{B as S,D}from"./Charts-c0264ed6.js";import{T as U}from"./TableHOC-09ebbe70.js";import"./iconBase-5d1ce741.js";const A="/assets/userpic-996d8bbc.png",H=[{Header:"User",accessor:"user"},{Header:"Time",accessor:"createdAt"},{Header:"Input",accessor:"input"},{Header:"Ouput",accessor:"output"},{Header:"Status",accessor:"status_code"}],k=({data:e=[]})=>U(H,e,"transaction-box","Recent Calls")(),O=()=>{const[e,r]=n.useState(null),[t,c]=n.useState([]),[u,m]=n.useState([]),[g,b]=n.useState([]),[l,f]=n.useState([30,2,56,22]);return n.useEffect(()=>{(async()=>{try{const i=await fetch("https://truefoundry-0-0-0-release.onrender.com/dashboard/top-metrics"),j=await fetch("https://truefoundry-0-0-0-release.onrender.com/dashboard/latest5"),p=await fetch("https://truefoundry-0-0-0-release.onrender.com/dashboard/env"),x=await fetch("https://truefoundry-0-0-0-release.onrender.com/dashboard/gpt-models"),w=await fetch("https://truefoundry-0-0-0-release.onrender.com/dashboard/latest-logs");if(!x.ok)throw new Error("Failed to fetch GPT models data");if(!i.ok||!j.ok||!p.ok)throw new Error("Failed to fetch data");const v=await i.json(),y=await j.json(),E=await p.json(),C=await x.json(),d=await w.json();if(r(v),b(C),m(E),c(y),e){const o=[0,0,0,0];console.log(e.totalEntries),o[0]=(e.totalEntries-d[0])/e.totalEntries*100,o[1]=(e.totalUniqueUsers-d[1])/e.totalUniqueUsers*100,o[2]=(e.averageCallsInLast30Days-d[2])/e.averageCallsInLast30Days*100,o[3]=(e.averageMetricsLatency-d[3])/e.averageMetricsLatency*100,f(o)}}catch(i){console.error("Error fetching data:",i)}})()},[]),s.jsxs("div",{className:"admin-container",children:[s.jsx(N,{}),s.jsxs("main",{className:"dashboard",children:[s.jsxs("div",{className:"bar",children:[s.jsx("img",{src:A,alt:"User"}),s.jsx("div",{children:"NOTE : Refresh the page to update the graphs and charts"})]}),s.jsxs("section",{className:"widget-container",children:[s.jsx(h,{percent:l[0],amount:!0,value:(e==null?void 0:e.totalEntries)??0,heading:"Total Revenue",color:"rgb(0,115,255)"}),s.jsx(h,{percent:-l[1],value:(e==null?void 0:e.totalUniqueUsers)??0,heading:"Users",color:"rgb(0 198 202)"}),s.jsx(h,{percent:l[2],value:(e==null?void 0:e.averageCallsInLast30Days)??0,heading:"Calls(30d)",color:"rgb(255 196 0)"}),s.jsx(h,{percent:l[3],value:(e==null?void 0:e.averageMetricsLatency)??0,heading:"Avg Latency (msec)",color:"rgb(76 0 255)"})]}),s.jsxs("section",{className:"graph-container",children:[s.jsxs("section",{children:[s.jsx(S,{data_1:g.map(a=>a.total_requests),title_1:"API CALLS",bgColor_1:"hsl(240, 40%, 50%)",labels:g.map(a=>a.model),data_2:[],title_2:"",bgColor_2:""}),s.jsx("h2",{children:"AGGREGRATE GPT MODEL DISTRIBUTION"})]}),s.jsxs("div",{className:"dashboard-categories",children:[s.jsx("h2",{children:"Environment-Wise Distribution"}),s.jsx("div",{children:u.map(a=>s.jsx(_,{heading:a.env,value:a.percentage,color:`hsl(${a.percentage*4},${a.percentage}%,50%)`},a.env))})]})]}),s.jsxs("section",{className:"transaction-container",children:[s.jsxs("div",{className:"success-chart",children:[s.jsx("h2",{children:"API Success Ratio"}),s.jsx(D,{labels:["Success","Fails"],data:[(e==null?void 0:e.totalSuccess)??90,(e==null?void 0:e.totalFailures)??0],backgroundColor:["rgba(53,162,235,0.8)","hsl(0, 20%, 50%)"],cutout:90}),s.jsxs("p",{children:[s.jsx(T,{}),s.jsx(L,{})]})]}),s.jsx(k,{data:t})]})]})]})},h=({heading:e,value:r,percent:t,color:c,amount:u=!1})=>s.jsxs("article",{className:"widget",children:[s.jsxs("div",{className:"widget-info",children:[s.jsx("p",{children:e}),s.jsx("h4",{children:u?`$${r}`:r}),t>0?s.jsxs("span",{className:"green",children:[s.jsx(I,{})," +",t,"%"," "]}):s.jsxs("span",{className:"red",children:[s.jsx(R,{})," ",t,"%"," "]})]}),s.jsx("div",{className:"widget-circle",style:{background:`conic-gradient(
        ${c} ${Math.abs(t)/100*360}deg,
        rgb(255, 255, 255) 0
      )`},children:s.jsxs("span",{style:{color:c},children:[t,"%"]})})]}),_=({color:e,value:r,heading:t})=>s.jsxs("div",{className:"category-item",children:[s.jsx("h5",{children:t}),s.jsx("div",{children:s.jsx("div",{style:{backgroundColor:e,width:`${r}%`}})}),s.jsxs("span",{children:[r,"%"]})]});export{O as default};
